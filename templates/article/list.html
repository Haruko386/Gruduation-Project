<img src="https://i0.hdslb.com/bfs/space/c467024d2cbeecb03af3acbabb7d41f2f7d4a5ff.png@2560w_400h_100q_1o.webp" class="banners">
{% extends "base.html" %}
{% load static %}

{% block title %}
    Title
{% endblock title %}

{% block content %}
    <style>
        .body {
            background-color: #2D93CA;
        }

        .item-box {

        }

        .end-banner-container {
            flex: 1;
        }

        /* è‡ªå®šä¹‰æ ·å¼ï¼Œå¯èƒ½éœ€è¦æ ¹æ®ä½ çš„base.htmlä¸­çš„æ ·å¼è¿›è¡Œè°ƒæ•´ */
        .containers {
            display: flex;
            flex-direction: row;
            margin: auto;
            background-color: white;
            border-radius: 40px;
        }

        .carousel-container {
            flex: 1;
            /* å…¶ä»–è½®æ’­å›¾æ ·å¼ */
        }

        .article-list-container {
            flex: 1; /* å‡è®¾æˆ‘ä»¬æƒ³è¦æ–‡ç« åˆ—è¡¨å æ®æ›´å¤šç©ºé—´ */
            margin-left: 20px; /* å·¦ä¾§ä¸è½®æ’­å›¾ä¹‹é—´çš„é—´è· */
            right: 0;
            max-height: 400px;
            overflow: auto;
            position: relative;
            /* å…¶ä»–æ–‡ç« åˆ—è¡¨æ ·å¼ */
        }

        .article-item {
            /* å•ä¸ªæ–‡ç« æ¡ç›®çš„æ ·å¼ */
        }

        .article-image {
            width: 100px; /* å‡è®¾çš„å›¾ç‰‡å®½åº¦ */
            height: auto;
            float: left; /* å‡è®¾å›¾ç‰‡æµ®åŠ¨åœ¨å·¦ä¾§ */
            margin-right: 10px; /* å›¾ç‰‡ä¸æ–‡å­—ä¹‹é—´çš„é—´è· */
        }

        .gray-box {
            background-color: #f0f0f0; /* ç°è‰²èƒŒæ™¯ */
            padding: 20px; /* å†…éƒ¨é—´è· */
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); /* é˜´å½±æ•ˆæœ */
            /* å…¶ä»–æ ·å¼ï¼Œå¦‚å®½åº¦ã€é«˜åº¦ã€è¾¹è·ç­‰ */
            background-image: url("{% static 'img/background.png' %}");
        }

        .containers-img {
            display: flex;
            justify-content: space-between; /* å¦‚æœéœ€è¦å›¾ç‰‡ä¹‹é—´æœ‰é—´éš” */
            align-items: center; /* å‚ç›´å±…ä¸­å¯¹é½ï¼Œå¦‚æœå›¾ç‰‡å¤§å°ä¸ä¸€è‡´å¯èƒ½éœ€è¦è°ƒæ•´ */
            width: 85%;
            margin: auto;
        }

        .image-container {
            /* æ ¹æ®éœ€è¦è®¾ç½®å›¾ç‰‡å®¹å™¨çš„æ ·å¼ï¼Œæ¯”å¦‚å®½åº¦ã€é«˜åº¦ã€è¾¹è·ç­‰ */
            /* å¦‚æœå›¾ç‰‡å¤§å°ç›¸åŒï¼Œå¯ä»¥çœç•¥å®½åº¦å’Œé«˜åº¦è®¾ç½® */
            flex: 1; /* å¦‚æœæƒ³è¦å›¾ç‰‡ç­‰å®½æ’åˆ— */
            margin: 5px; /* è®¾ç½®å›¾ç‰‡ä¹‹é—´çš„é—´è· */
            text-align: center; /* ç¡®ä¿å›¾ç‰‡åœ¨å®¹å™¨ä¸­å±…ä¸­æ˜¾ç¤ºï¼ˆç‰¹åˆ«æ˜¯å¦‚æœå®¹å™¨å®½åº¦å¤§äºå›¾ç‰‡æ—¶ï¼‰*/
            border-radius: 40px;
        }

        .image-container img {
            /* è®¾ç½®å›¾ç‰‡çš„æ ·å¼ï¼Œæ¯”å¦‚æœ€å¤§å®½åº¦ã€é«˜åº¦ç­‰ */
            max-width: 100%; /* ä¿è¯å›¾ç‰‡ä¸ä¼šè¶…å‡ºå®¹å™¨å®½åº¦ */
            height: auto; /* è‡ªåŠ¨è°ƒæ•´é«˜åº¦ä»¥ä¿æŒå›¾ç‰‡æ¯”ä¾‹ */
        }

        .article-list-containers {
            display: flex;
            justify-content: space-between;
            border: 1px solid #ccc;
            padding: 10px;
            overflow: auto;
            max-height: 570px;
        }

        .article-items {
            flex: 0 0 calc(33.33% - 10px);
            margin-right: 10px;
            border-right: 1px solid #ccc;
            padding: 0 10px;
            max-height: 719px;
        }

        .article-items:last-child {
            margin-right: 0;
            border-right: none;
        }

        .box01 {
            margin: auto;
            max-width: 84%;
        }

        .box02 {
            margin: auto;
        }

        .box03 {
            background-color: white;
            margin: auto;
            max-width: 75%;
            border-radius: 20px;
        }

        .info-box {
            position: fixed;
            top: 145px; /* è·ç¦»é¡¶éƒ¨çš„è·ç¦» */
            right: 20px; /* è·ç¦»å³ä¾§çš„è·ç¦» */
            background-color: #f0f0f0; /* èƒŒæ™¯è‰² */
            border: 1px solid #ccc; /* è¾¹æ¡† */
            padding: 10px;
            border-radius: 20px;
            width: 160px;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        .end-banner {
            max-width: 85%;
            max-height: 135px;
        }

        .header_news {
            height: 50px;
            margin-top: 20px;
            background-color: white;
            border: unset;
            border-bottom: 1px solid #eeeeee;
            position: sticky;
            top: 0; /* å›ºå®šåœ¨é¡µé¢é¡¶éƒ¨ */
        }

    </style>
    <script>
        window.addEventListener('scroll', function () {
            var infoBox = document.getElementById('infoBox');
            var distanceFromTop = infoBox.getBoundingClientRect().top + window.scrollY;
            var opacity = infoBox.getAttribute(opacity);

            var windowHeight = window.innerHeight;

            // è®¡ç®—å¯è§éƒ¨åˆ†çš„é«˜åº¦
            var visibleHeight = windowHeight - distanceFromTop;
            console.log(visibleHeight)
            // æ ¹æ®å¯è§é«˜åº¦è®¾ç½®é€æ˜åº¦
            if (visibleHeight > 405) {
                opacity = 0;
            } else opacity = 1;

            // è®¾ç½®é€æ˜åº¦
            infoBox.style.opacity = opacity;
        });
        // è·å–IPåœ°å€
        fetch('https://api.ipify.org?format=json')
            .then(response => response.json())
            .then(data => {
                document.getElementById('ip-address').innerText = data.ip;
                // ä½¿ç”¨ç¬¬ä¸‰æ–¹APIè·å–IPæ‰€åœ¨ä½ç½®ï¼Œè¿™é‡Œä½¿ç”¨äº†ipapi.coçš„API
                fetch(`https://ipapi.co/${data.ip}/json/`)
                    .then(response => response.json())
                    .then(locationData => {
                        document.getElementById('location').innerText = `${locationData.city}, ${locationData.region}, ${locationData.country}`;
                        // è·å–ä½ç½®çš„å¤©æ°”ä¿¡æ¯
                        const apiKey = 'SyHeI4iWMkMRSBac1';
                        const city = locationData.city;
                        console.log(city)
                        const apiUrl = `https://api.seniverse.com/v3/weather/now.json?key=SyHeI4iWMkMRSBac1&location=${city}&language=zh-Hans&unit=c`;
                        console.log(apiUrl)
                        fetch(apiUrl)
                            .then(response => response.json())
                            .then(weatherData => {
                                console.log(weatherData, 'haruka')
                                const weather = weatherData.results[0].now.text
                                document.getElementById('weather').innerText = `å½“å‰å¤©æ°”${weather}`;
                            })
                            .catch(error => console.error('è·å–å¤©æ°”ä¿¡æ¯å¤±è´¥ï¼š', error));
                    })
                    .catch(error => console.error('è·å–ä½ç½®ä¿¡æ¯å¤±è´¥ï¼š', error));
            })
            .catch(error => console.error('è·å–IPåœ°å€å¤±è´¥ï¼š', error));
        // æ¯ç§’æ›´æ–°ä¸€æ¬¡æµè§ˆå™¨ä¿¡æ¯
        setInterval(updatePerformanceInfo, 1000);
    </script>
    <div class="info-box" id="infoBox">
        <h4 align="center">å°ç«™èµ„è®¯ğŸ“ </h4>
        <div class="clock ml-auto">
            <h3 align="center" class="clocks">ğŸ•§</h3>
            <p id="current-time" class="time-animate clocks" align="center">åŠ è½½ä¸­â€¦â€¦</p>
        </div>
        <p align="center">IPåœ°å€ğŸ•¸ï¸<span id="ip-address"></span></p>
        <p align="center">æ‰€åœ¨ä½ç½®ğŸŒ<span id="location"></span></p>
        <div class="clocks hitokoto">
            <p align="center">HitokotoğŸ’¬</p>
            <p id="hitokoto" class="hitokoto" align="center">åŠ è½½ä¸­â€¦â€¦</p>
        </div>
        <div id="weather" align="center">å¤©æ°”åŠ è½½ä¸­...</div>
    </div>
    <div class="gray-box">
        <div class="box03">
            <div class="box02" id="box02">
                <h3 align="center"><a target="_blank" title="å…¨å›½åŠ©æ®‹æ—¥ï¼Œèµ°è¿›ä¹ è¿‘å¹³æ€»ä¹¦è®°å¿ƒä¸­è¿™ä»½â€œæ˜¥å¤©çš„äº‹ä¸šâ€"
                                      href="/news/show-85024.html">å…¨å›½åŠ©æ®‹æ—¥ï¼Œèµ°è¿›ä¹ è¿‘å¹³æ€»ä¹¦è®°å¿ƒä¸­è¿™ä»½â€œæ˜¥å¤©çš„äº‹ä¸šâ€</a>
                </h3>
                <p align="center">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ä¹ è¿‘å¹³æ€»ä¹¦è®°æŒ‡å‡ºï¼šâ€œæ®‹ç–¾äººæ˜¯ä¸€ä¸ªç‰¹æ®Šå›°éš¾çš„ç¾¤ä½“ï¼Œéœ€è¦æ ¼å¤–å…³å¿ƒã€æ ¼å¤–å…³æ³¨ã€‚â€ä¸€å¹•å¹•æ¸©æƒ…ç¬é—´ï¼Œå‡ç»“ç€ä¹ è¿‘å¹³æ€»ä¹¦è®°å¯¹æ®‹ç–¾äººæ•°åå¹´ä¸å˜çš„æ·±æƒ…ã€‚</p>
            </div>
            <div class="divider"></div>
            <div class="container">
                <div class="containers">
                    <div class="carousel-container">
                        <div class="carousel-slides">
                            <!-- è½®æ’­å›¾çš„å›¾ç‰‡å’Œé“¾æ¥ -->
                            <div class="slide active" id="slide1">
                                <a href="#">
                                    <img src="{% static 'img/carousel/slide1.jpg' %}" alt="Slide 1">
                                </a>
                            </div>
                            <div class="slide active" id="slide2">
                                <a href="#">
                                    <img src="{% static 'img/carousel/slide2.jpg' %}" alt="Slide 2">
                                </a>
                            </div>
                            <div class="slide active" id="slide3">
                                <a href="#">
                                    <img src="{% static 'img/carousel/slide3.jpg' %}" alt="Slide 3">
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="article-list-container">
                        <div class="item-box">
                            <h2 class="header_news" align="center">åº”æ€¥è¦é—»</h2>
                            <hr>
                            {% for article in articles %}
                                {% if article.column_id and article.column_id == 1 %}
                                    <div class="article-item">
                                        <h5><a href="{% url 'article:article_detail' article.id %}"
                                               style="color: black;">{{ article.title }}</a></h5>
                                        <p align="center">{{ article.content|slice:'68' }}</p>
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>

                </div>
            </div>


            <hr>
            <div class="box01"><a href="https://www.mem.gov.cn/xw/ztzl/xxzl/" target="_blank">
                <img src="https://mempe.org.cn/templates/chinasafety5.0/images/topbanner.jpg"></a>
            </div>
            {#  è®°å¾—åŠ jsonæ–‡ä»¶  #}
            <div class="containers-img">
                <div class="image-container" id="slide11">
                    <a href="#">
                        <img src="{% static 'img/mid-banner/silde1.jpg' %}" alt="Slide 1">
                    </a>
                </div>
                <div class="image-container" id="slide22">
                    <a href="#">
                        <img src="{% static 'img/mid-banner/slide2.jpg' %}" alt="Slide 2">
                    </a>
                </div>
                <div class="image-container" id="slide33">
                    <a href="#">
                        <img src="{% static 'img/mid-banner/slide3.jpg' %}" alt="Slide 3">
                    </a>
                </div>
            </div>

            <hr>
            <div class="containers">
                <div class="article-list-container">
                    <h2 class="header_news" align="center">å®£æ•™ä¸­å¿ƒ</h2>
                    <hr>
                    {% for article in articles %}
                        {% if article.column_id and article.column_id == 7 %}
                            <div class="article-item">
                                <h5><a href="{% url 'article:article_detail' article.id %}"
                                       style="color: black;">{{ article.title }}</a></h5>
                                <p align="center">{{ article.content|slice:'68' }}</p>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
                <div class="end-banner-container">
                    <div class="image-container end-banner" id="slide111">
                        <a href="#">
                            <img src="{% static 'img/end-banner/slide1.jpg' %}" alt="Slide 1" class="end-banner">
                        </a>
                    </div>
                    <div class="image-container end-banner" id="slide222">
                        <a href="#">
                            <img src="{% static 'img/end-banner/slide2.jpg' %}" alt="Slide 1" class="end-banner">
                        </a>
                    </div>
                    <div class="image-container end-banner" id="slide333">
                        <a href="#">
                            <img src="{% static 'img/end-banner/slide3.jpg' %}" alt="Slide 1" class="end-banner">
                        </a>
                    </div>
                </div>
            </div>
            <hr>

            <div class="container">
                <div class="article-list-containers">
                    <div class="article-items">
                        <h2 class="header_news" align="center">æ—¶æ”¿ä¸“æ </h2>
                        <hr>
                        {% for article in articles %}
                            {% if article.column_id == 4 %}
                                <h5 align="center"><a href="{% url 'article:article_detail' article.id %}"
                                                      style="color: black;"
                                >
                                    {{ article.title }}
                                </a></h5>
                                <p align="center">{{ article.content|slice:'68' }}</p> <!-- å‡è®¾articleå¯¹è±¡æœ‰summaryå­—æ®µ -->
                            {% endif %}
                        {% endfor %}
                    </div>
                    <div class="article-items">
                        <h2 class="header_news" align="center">é€šçŸ¥å…¬å‘Š</h2>
                        <hr>
                        {% for article in articles %}
                            {% if article.column_id == 5 %}
                                <h5 align="center"><a href="{% url 'article:article_detail' article.id %}"
                                                      style="color: black;"
                                >
                                    {{ article.title }}
                                </a></h5>
                                <p align="center">{{ article.content|slice:'68' }}</p> <!-- å‡è®¾articleå¯¹è±¡æœ‰summaryå­—æ®µ -->
                            {% endif %}
                        {% endfor %}
                    </div>
                    <div class="article-items">
                        <h2 class="header_news" align="center">æ”¿ç­–è§£è¯»</h2>
                        <hr>
                        {% for article in articles %}
                            {% if article.column_id == 6 %}
                                <h5 align="center"><a href="{% url 'article:article_detail' article.id %}"
                                                      style="color: black;"
                                >
                                    {{ article.title }}
                                </a></h5>
                                <p align="center">{{ article.content|slice:'68' }}</p> <!-- å‡è®¾articleå¯¹è±¡æœ‰summaryå­—æ®µ -->
                            {% endif %}
                        {% endfor %}
                    </div>
                </div>
            </div>
            <hr>
        </div>
    </div>
    <hr>
    <script>
        fetch('https://mempe.org.cn/')
            .then(response => response.text()) // å°†å“åº”è½¬æ¢ä¸ºçº¯æ–‡æœ¬
            .then(html => {
                // åˆ›å»ºä¸€ä¸ªä¸´æ—¶ div å…ƒç´ ç”¨äºå®¹çº³ç½‘é¡µçš„å†…å®¹
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = html;

                // é€šè¿‡é€‰æ‹©å™¨æ‰¾åˆ°æŒ‡å®šçš„å†…å®¹
                const boxContent = tempDiv.querySelector('.box02');
                const title = boxContent.querySelector('h3 a').innerText;
                const paragraph = boxContent.querySelector('p').innerText;

                // å°†è·å–çš„æ ‡é¢˜å’Œæ®µè½å†…å®¹å†™å…¥åˆ°ä½ çš„ç½‘é¡µä¸­
                const contentDiv = document.getElementById('box02');
                contentDiv.innerHTML = `<h3 align="center">${title}</h3><p align="center">${paragraph}</p>`;
                console.log("gfubonaebfa")
            })
            .catch(error => {
                console.error('Fetch Error:', error);
            });

        function toggleLinks(category) {
            var linkList = category.querySelector('.link-list');
            linkList.classList.toggle('show');
        }

        let currentIndex = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;
        let slideInterval; // ç”¨äºå­˜å‚¨å®šæ—¶å™¨çš„å¼•ç”¨

        function nextSlide() {
            currentIndex = (currentIndex + 1) % totalSlides;
            updateSlide();
        }

        function prevSlide() {
            currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
            updateSlide();
        }

        function updateSlide() {
            const offset = -currentIndex * 100;
            document.querySelector('.carousel-slides').style.transform = `translateX(${offset}%)`;
        }

        // åˆå§‹åŒ–ç¬¬ä¸€å¼ å¹»ç¯ç‰‡å¹¶å¯åŠ¨è‡ªåŠ¨æ’­æ”¾
        updateSlide();
        startAutoSlide(); // æ–°å¢å‡½æ•°è°ƒç”¨

        function startAutoSlide() {
            slideInterval = setInterval(nextSlide, 5000); // æ¯5ç§’åˆ‡æ¢ä¸€æ¬¡
        }


        function updateTime() {
            let now = new Date();
            let dateTimeString = `${now.getFullYear()}-${(now.getMonth() + 1).toString().padStart(2, '0')}-${now.getDate().toString().padStart(2, '0')} ${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}`;

            document.getElementById('current-time').classList.remove('time-animate');
            // æ›´æ–°æ—¶é—´
            document.getElementById('current-time').innerText = dateTimeString;
            // ç¨ä½œå»¶è¿Ÿåé‡æ–°æ·»åŠ åŠ¨ç”»ç±»ï¼Œç¡®ä¿åŠ¨ç”»å¯è§
            setTimeout(() => {
                document.getElementById('current-time').classList.add('time-animate');
            }, 10);
        }

        // åˆå§‹åŒ–æ—¶é—´æ˜¾ç¤ºå¹¶å¼€å§‹å¾ªç¯æ›´æ–°
        setInterval(updateTime, 1000);


        const hitokotoapi = 'https://v1.hitokoto.cn/';

        fetch(hitokotoapi)
            .then(response => response.json())
            .then(data => {
                // æ›´æ–°åè¨€å†…å®¹
                document.getElementById('hitokoto').innerText = data.hitokoto;
                console.log("succeed")
            })
            .catch(error => console.error('Error:', error));

        fetch("{% static 'img/end-banner/link.json' %}")
            .then(response => response.json())
            .then(data => {
                document.querySelector('#slide111 a').href = data.slide1;
                document.querySelector('#slide222 a').href = data.slide2;
                document.querySelector('#slide333 a').href = data.slide3;
            })
            .catch(error => console.error('Error fetching JSON:', error));


        fetch("{% static 'img/mid-banner/link.json' %}")
            .then(response => response.json())
            .then(data => {
                document.querySelector('#slide11 a').href = data.slide1;
                document.querySelector('#slide22 a').href = data.slide2;
                document.querySelector('#slide33 a').href = data.slide3;
            })
            .catch(error => console.error('Error fetching JSON:', error));

        fetch("{% static 'carousel.json' %}")
            .then(response => response.json())
            .then(data => {
                document.querySelector('#slide1 a').href = data.slide1;
                document.querySelector('#slide2 a').href = data.slide2;
                document.querySelector('#slide3 a').href = data.slide3;
            })
            .catch(error => console.error('Error fetching JSON:', error));
    </script>
{% endblock content %}